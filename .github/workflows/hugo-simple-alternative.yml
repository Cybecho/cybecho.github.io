name: Hugo Simple Deploy

on:
  push:
    branches: ["main"]
  workflow_dispatch:

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          submodules: true
          fetch-depth: 0

      - name: Setup Pages
        id: pages
        uses: actions/configure-pages@v4

      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v3
        with:
          hugo-version: 'latest'
          extended: true

      # ì¼ë‹¨ ê¸°ì¡´ ì½˜í…ì¸ ë¡œë§Œ ë¹Œë“œ
      - name: Create sample content
        run: |
          mkdir -p content/posts/first-post
          cat > content/posts/first-post/index.md << 'EOF'
          ---
          title: "ì²« ë²ˆì§¸ ê¸€: ì‚½ì§ˆ ì €ìž¥ì†Œ ì˜¤í”ˆ!"
          date: 2024-01-20T00:00:00+09:00
          draft: false
          tags: ["ì²«ê¸€", "ì‹œìž‘"]
          categories: ["ê³µì§€"]
          ---

          # ì‚½ì§ˆ ì €ìž¥ì†Œê°€ ì˜¤í”ˆë˜ì—ˆìŠµë‹ˆë‹¤! ðŸŽ‰

          ì•ˆë…•í•˜ì„¸ìš”, **Cybecho**ìž…ë‹ˆë‹¤!

          ë“œë””ì–´ ì œ ê°œì¸ ê¸°ìˆ  ë¸”ë¡œê·¸ì¸ **ì‚½ì§ˆ ì €ìž¥ì†Œ**ê°€ ì˜¤í”ˆë˜ì—ˆìŠµë‹ˆë‹¤.

          ## ì™œ "ì‚½ì§ˆ ì €ìž¥ì†Œ"ì¸ê°€ìš”?

          ê°œë°œì„ í•˜ë‹¤ ë³´ë©´ ìˆ˜ë§Žì€ ì‹œí–‰ì°©ì˜¤ë¥¼ ê²ªê²Œ ë©ë‹ˆë‹¤. 
          ì´ëŸ° "ì‚½ì§ˆ"ë“¤ë„ ì†Œì¤‘í•œ ê²½í—˜ì´ìž í•™ìŠµ ê³¼ì •ì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.

          - âŒ ì‹¤íŒ¨í•œ ì‹œë„ë“¤
          - âœ… ì„±ê³µí•œ í•´ê²°ì±…ë“¤  
          - ðŸ¤” ê¶ê¸ˆí–ˆë˜ ê¸°ìˆ ë“¤
          - ðŸ’¡ ê¹¨ë‹¬ì€ ì¸ì‚¬ì´íŠ¸ë“¤

          ëª¨ë“  ê²ƒë“¤ì„ ì´ê³³ì— ì°¨ê³¡ì°¨ê³¡ ì €ìž¥í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

          ## ì•žìœ¼ë¡œì˜ ê³„íš

          - **Notion ì—°ë™**: ê³§ Notionì—ì„œ ìž‘ì„±í•œ ê¸€ë“¤ì´ ìžë™ìœ¼ë¡œ ë™ê¸°í™”ë  ì˜ˆì •
          - **ë‹¤ì–‘í•œ ì£¼ì œ**: í”„ë¡ íŠ¸ì—”ë“œ, ë°±ì—”ë“œ, ì¸í”„ë¼, DevOps ë“±
          - **ì‹¤ë¬´ ê²½í—˜ ê³µìœ **: ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œì˜ ê²½í—˜ë‹´

          ì•žìœ¼ë¡œ ë§Žì€ ê´€ì‹¬ê³¼ í”¼ë“œë°± ë¶€íƒë“œë¦½ë‹ˆë‹¤! ðŸ˜Š

          ---
          *GitHub: [@Cybecho](https://github.com/Cybecho)*
          EOF

      - name: Build with Hugo
        env:
          HUGO_ENVIRONMENT: production
        run: hugo --gc --minify

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./public

  deploy-to-pages:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: deploy
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
